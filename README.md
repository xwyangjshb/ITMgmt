备注 以下使用TRAE工具协助生成
## 功能需求说明

收集局域网内的设备IP，MAC地址，登记他们的信息，然后将这些信息的上下游关系，如某点机器 是虚拟机时，它隶属某台物理ESXI服务器，这些信息都做好记录，然后视需要，在必要进使用远程Wake on lan 唤醒这些主机，投入使用，使用完毕后，再自动的关机。

## 系统架构建议
### 1. 技术栈选择
- 后端 : ASP.NET Core Web API + SignalR (实时通信)
- 数据库 : SQL Server 或 PostgreSQL (存储设备信息和关系)
- 前端 : Blazor Server 或 React/Vue.js (管理界面)
- 网络发现 : System.Net.NetworkInformation + ARP扫描
- Wake-on-LAN : 自定义UDP数据包发送
### 2. 核心功能模块 设备发现服务
- 网络扫描 : 定期扫描局域网IP段，发现活跃设备
- MAC地址获取 : 通过ARP表获取设备MAC地址
- 设备识别 : 通过端口扫描、SNMP查询识别设备类型
- VMware集成 : 通过vSphere API获取虚拟机与ESXi主机关系
- 电源管理服务
- Wake-on-LAN : 发送魔术包唤醒设备
- 远程关机 : SSH/WMI/IPMI协议执行关机命令
- 任务调度 : 基于时间或条件的自动化开关机
### 3. 实现建议 第一阶段：基础框架
   创建ASP.NET Core项目结构
   设计数据库模型和Entity Framework配置
   实现基础的设备CRUD操作 第二阶段：设备发现
   实现网络扫描服务 (Ping + ARP)
   集成VMware vSphere API
   建立设备关系映射 第三阶段：电源管理
   实现Wake-on-LAN功能
   集成远程关机方案
   添加任务调度器 第四阶段：用户界面
   创建设备管理界面
   实现拓扑关系可视化
   添加批量操作功能
### 4. 技术要点 网络发现优化
- 使用多线程并行扫描提高效率
- 实现增量扫描，只检查变化的设备
- 支持自定义IP段和排除列表 安全考虑
- 实现基于角色的访问控制
- 加密存储敏感信息 (如SSH密钥)
- 审计日志记录所有操作 可扩展性
- 支持插件化的设备类型识别
- 模块化的电源管理协议
- RESTful API供第三方集成
